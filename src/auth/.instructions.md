---
applyTo: 'src/auth/**'
---

# Auth Module Instructions

## Security Requirements
- Hash passwords using bcrypt (min 10 rounds)
- JWT tokens: access (15min), refresh (7days)
- Store refresh tokens in database
- Implement token rotation on refresh

## Validation Rules
- Email: valid format, unique
- Password: min 8 characters, require uppercase + lowercase + number
- Phone: Vietnamese format validation

## Error Messages
- Return generic messages for login failures (don't reveal if email exists)
- Use Vietnamese for user-facing errors
- Log detailed errors server-side only

## Guards & Decorators
- Use `@UseGuards(JwtAuthGuard)` for protected routes
- Use `@Public()` decorator to bypass auth on specific routes
- Use `@CurrentUser()` decorator to get authenticated user
